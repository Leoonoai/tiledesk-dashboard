"use strict";(self.webpackChunkchat21=self.webpackChunkchat21||[]).push([[1421],{41421:(G,u,c)=>{c.r(u),c.d(u,{PaymentsListModule:()=>q});var g=c(69808),b=c(54132),_=c(87341),h=c(27544),m=c(354),P=c(48616),t=c(5e3),d=c(51062),f=c(39850);function C(e,i){1&e&&t._UZ(0,"loading-spinner")}function j(e,i){1&e&&(t.TgZ(0,"tr")(1,"td",15)(2,"p",16),t._uU(3),t.ALo(4,"translate"),t.qZA()()()),2&e&&(t.xp6(3),t.hij(" ",t.lcZ(4,1,"Pricing.NoPayments")," "))}function x(e,i){1&e&&(t.TgZ(0,"span")(1,"span",18),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&e&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"SubscriptionCreated")," "))}function T(e,i){1&e&&(t.TgZ(0,"span")(1,"span",18),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&e&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"SubscriptionRenewed")," "))}const M=function(e,i){return{first:e,last:i}};function v(e,i){if(1&e&&(t.TgZ(0,"span",26),t._uU(1),t.ALo(2,"date"),t.ALo(3,"date"),t.qZA()),2&e){const n=i.$implicit;t.Q6J("ngClass",t.WLB(9,M,i.first,i.last)),t.xp6(1),t.AsE(" ",t.xi3(2,3,1e3*n.period.start,"dd/MM/y HH:mm:ss")," -> ",t.xi3(3,6,1e3*n.period.end,"dd/MM/y HH:mm:ss")," ")}}function I(e,i){if(1&e&&(t.TgZ(0,"tr")(1,"td",17)(2,"span",18),t._uU(3),t.qZA()(),t.TgZ(4,"td",17),t.YNc(5,x,4,3,"span",7),t.YNc(6,T,4,3,"span",7),t.qZA(),t.TgZ(7,"td",17)(8,"span",18),t._uU(9),t.ALo(10,"date"),t.qZA()(),t.TgZ(11,"td")(12,"span",18),t.YNc(13,v,4,12,"span",19),t.ALo(14,"slice"),t.qZA()(),t.TgZ(15,"td",20)(16,"a",21)(17,"i",22),t._uU(18," open_in_new "),t.qZA(),t.TgZ(19,"span",23),t._uU(20),t.ALo(21,"translate"),t.qZA()(),t.TgZ(22,"a",24)(23,"i",25),t._uU(24," save_alt "),t.qZA(),t.TgZ(25,"span",23),t._uU(26),t.ALo(27,"translate"),t.qZA()()()()),2&e){const n=i.$implicit;t.xp6(3),t.hij(" ",null==n||null==n.object||null==n.object.data||null==n.object.data.object?null:n.object.data.object.id," "),t.xp6(2),t.Q6J("ngIf","subscription_create"===(null==n||null==n.object?null:n.object.data.object.billing_reason)),t.xp6(1),t.Q6J("ngIf","subscription_cycle"===(null==n||null==n.object?null:n.object.data.object.billing_reason)),t.xp6(3),t.hij(" ",t.xi3(10,9,1e3*(null==n||null==n.object||null==n.object.data.object||null==n.object.data.object.status_transitions?null:n.object.data.object.status_transitions.paid_at),"dd/MM/y HH:mm:ss")," "),t.xp6(4),t.Q6J("ngForOf",t.Dn7(14,12,null==n||null==n.object||null==n.object.data||null==n.object.data.object||null==n.object.data.object.lines||null==n.object.data.object.lines.data?null:n.object.data.object.lines.data.slice().reverse(),0,1)),t.xp6(3),t.Q6J("href",null==n||null==n.object||null==n.object.data||null==n.object.data.object?null:n.object.data.object.hosted_invoice_url,t.LSH),t.xp6(4),t.hij(" ",t.lcZ(21,16,"ViewInvoice")," "),t.xp6(2),t.Q6J("href",null==n||null==n.object||null==n.object.data||null==n.object.data.object?null:n.object.data.object.invoice_pdf,t.LSH),t.xp6(4),t.hij(" ",t.lcZ(27,18,"DownloadInvoice")," ")}}function Z(e,i){if(1&e&&(t.TgZ(0,"div",10)(1,"table",11)(2,"thead",12)(3,"tr")(4,"th")(5,"span",13),t._uU(6),t.ALo(7,"translate"),t.qZA()(),t.TgZ(8,"th")(9,"span",13),t._uU(10),t.ALo(11,"translate"),t.qZA()(),t.TgZ(12,"th")(13,"span",13),t._uU(14),t.ALo(15,"translate"),t.qZA()(),t.TgZ(16,"th")(17,"span",13),t._uU(18),t.ALo(19,"translate"),t.qZA()(),t.TgZ(20,"th")(21,"span",13),t._uU(22),t.ALo(23,"translate"),t.qZA()()()(),t.TgZ(24,"tbody"),t.YNc(25,j,5,3,"tr",7),t.YNc(26,I,28,20,"tr",14),t.qZA()()()),2&e){const n=t.oxw();t.xp6(6),t.hij(" ID ",t.lcZ(7,7,"Invoice")," "),t.xp6(4),t.hij(" ",t.lcZ(11,9,"Event")," "),t.xp6(4),t.hij(" ",t.lcZ(15,11,"PaymentDate")," "),t.xp6(4),t.hij(" ",t.lcZ(19,13,"Period")," "),t.xp6(4),t.hij(" ",t.lcZ(23,15,"Invoice")," "),t.xp6(3),t.Q6J("ngIf",n.subscription_payments&&0===(null==n.subscription_payments?null:n.subscription_payments.length)),t.xp6(1),t.Q6J("ngForOf",n.subscription_payments)}}function A(e,i){1&e&&t._UZ(0,"loading-spinner")}function O(e,i){1&e&&(t.TgZ(0,"span")(1,"span",33),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&e&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"SubscriptionCreated")," "))}function L(e,i){1&e&&(t.TgZ(0,"span")(1,"span",33),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&e&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"SubscriptionRenewed")," "))}function y(e,i){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"tr",28)(2,"td"),t._uU(3),t.qZA(),t.TgZ(4,"td"),t.YNc(5,O,4,3,"span",7),t.YNc(6,L,4,3,"span",7),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.ALo(9,"date"),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.ALo(12,"number"),t.qZA(),t.TgZ(13,"td",29)(14,"button",30),t.NdJ("click",function(l){const a=t.CHM(n).$implicit,s=t.oxw(2);return l.stopPropagation(),t.KtG(s.viewRecepit(null==a||null==a.object||null==a.object.data||null==a.object.data.object?null:a.object.data.object.hosted_invoice_url))}),t.TgZ(15,"i",31),t._uU(16,"open_in_new"),t.qZA(),t.TgZ(17,"span",32),t._uU(18),t.ALo(19,"translate"),t.qZA()(),t.TgZ(20,"button",30),t.NdJ("click",function(l){const a=t.CHM(n).$implicit,s=t.oxw(2);return l.stopPropagation(),t.KtG(s.viewInvoice(null==a||null==a.object||null==a.object.data||null==a.object.data.object?null:a.object.data.object.invoice_pdf))}),t.TgZ(21,"i",31),t._uU(22,"save_alt"),t.qZA(),t.TgZ(23,"span",32),t._uU(24),t.ALo(25,"translate"),t.qZA()()()(),t.BQk()}if(2&e){const n=i.$implicit;t.xp6(1),t.MGl("id","view_",null==n||null==n.object?null:n.object.id,""),t.xp6(2),t.Oqu(null==n||null==n.object||null==n.object.data||null==n.object.data.object?null:n.object.data.object.id),t.xp6(2),t.Q6J("ngIf","subscription_create"===(null==n||null==n.object?null:n.object.data.object.billing_reason)),t.xp6(1),t.Q6J("ngIf","subscription_cycle"===(null==n||null==n.object?null:n.object.data.object.billing_reason)),t.xp6(2),t.hij(" ",t.xi3(9,13,1e3*(null==n||null==n.object||null==n.object.data.object||null==n.object.data.object.status_transitions?null:n.object.data.object.status_transitions.paid_at),"dd/MM/y")," "),t.xp6(3),t.AsE(" ",t.xi3(12,16,(null==n||null==n.object||null==n.object.data.object?null:n.object.data.object.amount_paid)/100,"1.2-2")," ",null==n||null==n.object||null==n.object.data.object?null:n.object.data.object.currency," "),t.xp6(3),t.MGl("id","btn_openinnew_",null==n||null==n.object?null:n.object.id,""),t.xp6(1),t.MGl("id","icon_",null==n||null==n.object?null:n.object.id,""),t.xp6(3),t.hij(" ",t.lcZ(19,19,"ViewInvoice")," "),t.xp6(2),t.MGl("id","btn_dwnload_",null==n||null==n.object?null:n.object.id,""),t.xp6(1),t.MGl("id","icon_",null==n||null==n.object?null:n.object.id,""),t.xp6(3),t.hij(" ",t.lcZ(25,21,"DownloadInvoice")," ")}}function w(e,i){if(1&e&&(t.TgZ(0,"div",10)(1,"table",27)(2,"thead")(3,"tr")(4,"th"),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"th"),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"th"),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"th"),t._uU(14),t.ALo(15,"translate"),t.qZA(),t.TgZ(16,"th"),t._uU(17),t.ALo(18,"translate"),t.qZA()()(),t.TgZ(19,"tbody"),t.YNc(20,y,26,23,"ng-container",14),t.qZA()()()),2&e){const n=t.oxw();t.xp6(5),t.hij("ID ",t.lcZ(6,6,"Invoice"),""),t.xp6(3),t.Oqu(t.lcZ(9,8,"Event")),t.xp6(3),t.Oqu(t.lcZ(12,10,"PaymentDate")),t.xp6(3),t.Oqu(t.lcZ(15,12,"Amount")),t.xp6(3),t.hij(" ",t.lcZ(18,14,"Invoice"),""),t.xp6(3),t.Q6J("ngForOf",n.subscription_payments)}}const N=function(e){return{"margin-top":e}};let S=(()=>{class e{constructor(n,o,l,r,a,s){this.auth=n,this.prjctPlanService=o,this.prjctService=l,this.location=r,this.logger=a,this.translate=s,this.showSpinner=!0}ngOnInit(){this.getProjectPlan(),this.getBrowserVersion()}getLanguage(){const n=this.translate.getBrowserLang();if(this.auth.user_bs&&this.auth.user_bs.value){const o=localStorage.getItem(this.auth.user_bs.value._id+"_lang");this.logger.log("[PRICING - PAYMENT-LIST] stored_preferred_lang",o);let l="";n&&!o?(l=n,this.logger.log("[PRICING - PAYMENT-LIST] dshbrd_lang",l)):n&&o&&(l=o,this.logger.log("[PRICING - PAYMENT-LIST] dshbrd_lang",l))}}getBrowserVersion(){this.auth.isChromeVerGreaterThan100.subscribe(n=>{this.isChromeVerGreaterThan100=n})}getProjectPlan(){this.subscription=this.prjctPlanService.projectPlan$.subscribe(n=>{this.logger.log("[PRICING - PAYMENT-LIST] getProjectPlan project Profile Data",n),n&&n.subscription_id&&this.getSubscriptionPayments(n.subscription_id)},n=>{this.logger.error("[PRICING - PAYMENT-LIST] - getProjectPlan - ERROR",n)},()=>{this.logger.log("[PRICING - PAYMENT-LIST] - getProjectPlan * COMPLETE *")})}getSubscriptionPayments(n){this.prjctService.getSubscriptionPayments(n).subscribe(o=>{this.logger.log("[PRICING - PAYMENT-LIST] get subscriptionPayments ",o),o&&(this.subscription_payments=[],o.forEach(l=>{if(this.logger.log("[PRICING - PAYMENT-LIST] get subscriptionPayment ",l),this.logger.log("[PRICING - PAYMENT-LIST] get subscriptionPayment.stripe_event ",l.stripe_event),"invoice.payment_succeeded"===l.stripe_event){var r=0;l.object.data.object.lines.data.forEach((s,p)=>{this.logger.log("[PRICING - PAYMENT-LIST] subscriptionPayment ",p," line ",s),r++}),this.logger.log("[PRICING - PAYMENT-LIST] subscriptionPayment i ",r),r>1&&(l.has_detail=!0);const a=l.object.data.object.lines.data[0].description;if(this.logger.log("[PRICING - PAYMENT-LIST] subscriptionPayment plan_description: ",a),-1!==a.indexOf("\xd7")){const s=a.split("\xd7").pop();if(this.logger.log("[PRICING - PAYMENT-LIST] subscriptionPayment planSubstring: ",s),-1!==a.indexOf("(")){const p=s.substring(0,s.indexOf("("));this.logger.log("[PRICING - PAYMENT-LIST] subscriptionPayment planName: ",p),l.plan_name=p.trim()}if(-1!==a.indexOf("after")){const p=s.substring(0,s.indexOf("after"));this.logger.log("[PRICING - PAYMENT-LIST] subscriptionPayment planName: ",p),l.plan_name=p.trim()}}else l.plan_name=a;this.subscription_payments.push(l)}}),this.logger.log("[PRICING - PAYMENT-LIST] FILTERED subscriptionPayments ",this.subscription_payments))},o=>{this.logger.error("[PRICING - PAYMENT-LIST] get subscriptionPayments error ",o),this.showSpinner=!1},()=>{this.logger.log("[PRICING - PAYMENT-LIST] get subscriptionPayments * COMPLETE * "),this.showSpinner=!1})}toggle(n){let o;this.logger.log("[PRICING - PAYMENT-LIST] toggle event_id",n),o=document.querySelector(".fold-table  tr#view_"+n),this.logger.log("[PRICING - PAYMENT-LIST] toggle elemtr_viewv",o),o.classList.toggle("open");const l=document.querySelector("#fold_"+n);this.logger.log("[PRICING - PAYMENT-LIST] toggle foldTrElem",l),l.classList.toggle("open");const r=document.querySelector("#btn_dwnload_"+n);this.logger.log("[PRICING - PAYMENT-LIST] toggle btnDwnloadElem",r),r.classList.toggle("open");const a=document.querySelector("#btn_openinnew_"+n);this.logger.log("[PRICING - PAYMENT-LIST] toggle btnDwnloadElem",a),a.classList.toggle("open")}viewRecepit(n){this.logger.log("[PRICING - PAYMENT-LIST] viewRecepit",n),window.open(n,"_blank")}viewInvoice(n){this.logger.log("[PRICING - PAYMENT-LIST] viewInvoice",n),window.location.assign(n)}goBack(){this.location.back()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(_.e),t.Y36(h.E),t.Y36(m.Y),t.Y36(g.Ye),t.Y36(P.m),t.Y36(d.sK))},e.\u0275cmp=t.Xpm({type:e,selectors:[["appdashboard-payments-list"]],decls:17,vars:10,consts:[[1,"navbar-brand",2,"position","relative","z-index","1050",3,"ngStyle"],[1,"material-icons",2,"vertical-align","middle !important","cursor","pointer",3,"click"],[1,"main-content",2,"padding-top","0px","margin-top","35px"],[1,"container-fluid"],[1,"row"],[1,"col-md-12",2,"display","none"],[1,"card","card--no-border"],[4,"ngIf"],["class","card-content table-responsive","style","padding-bottom:5px",4,"ngIf"],[1,"col-md-12"],[1,"card-content","table-responsive",2,"padding-bottom","5px"],[1,"table","table-hover"],[1,"text"],[2,"font-size","14px","font-weight","500","color","#353f45"],[4,"ngFor","ngForOf"],["colspan","4",2,"text-align","center","padding-top","16px","cursor","pointer"],[2,"font-size","1em","color","#7695a5","font-weight","400"],[2,"white-space","nowrap","width","1%"],[2,"font-size","14px","line-height","21px","font-weight","500"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"td-actions","text-center"],["target","_blank",1,"tooltipx",3,"href"],[1,"material-icons"],[1,"tooltiptext-custom",2,"text-transform","none","height","40px","line-height","1.4","font-weight","200"],[1,"tooltipx",3,"href"],[1,"material-icons",2,"margin-left","16px"],[3,"ngClass"],[1,"table-hover"],[1,"view",3,"id"],[1,"td-actions","text-left"],["type","button",1,"btn","btn-primary","btn-simple","btn-xs","btn_in_accordion_table","tooltipx",2,"padding-left","1px","padding-right","5px",3,"id","click"],[1,"material-icons","accordion_table_icon",3,"id"],[1,"tooltiptext-custom",2,"text-transform","none","line-height","1.4","font-weight","200"],[2,"font-size","14px","line-height","21px"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"i",1),t.NdJ("click",function(){return o.goBack()}),t._uU(2,"keyboard_arrow_left"),t.qZA(),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div",2)(6,"div",3)(7,"div",4)(8,"div",5)(9,"div",6),t.YNc(10,C,1,0,"loading-spinner",7),t.YNc(11,Z,27,17,"div",8),t.qZA()(),t.TgZ(12,"div",4)(13,"div",9)(14,"div",6),t.YNc(15,A,1,0,"loading-spinner",7),t.YNc(16,w,21,16,"div",8),t.qZA()()()()()()),2&n&&(t.Q6J("ngStyle",t.VKq(8,N,!0===o.isChromeVerGreaterThan100?"-30px":"6px")),t.xp6(3),t.hij(" ",t.lcZ(4,6,"ProjectEditPage.Payments")," "),t.xp6(7),t.Q6J("ngIf",o.showSpinner),t.xp6(1),t.Q6J("ngIf",!o.showSpinner),t.xp6(4),t.Q6J("ngIf",o.showSpinner),t.xp6(1),t.Q6J("ngIf",!o.showSpinner))},dependencies:[g.mk,g.sg,g.O5,g.PC,f.g,g.OU,g.JJ,g.uU,d.X$],styles:['.tooltipx[_ngcontent-%COMP%] {\n  position: relative;\n  display: inline-block;\n}\n\n.tooltipx[_ngcontent-%COMP%]   .tooltiptext-custom[_ngcontent-%COMP%] {\n  visibility: hidden;\n  color: #fff;\n  text-align: center;\n  padding: 5px 5px;\n  border-radius: 5px;\n  font-size: 12px !important;\n  \n  position: absolute;\n  z-index: 1;\n  \n  bottom: 100%;\n  left: 50%;\n  margin-left: -60px; \n  max-width: 10em;\n  overflow-wrap: break-word;\n  box-shadow: 0 1em 2em -0.5em rgba(0, 0, 0, 0.35);\n  z-index: 1000;\n  background-color: #394f5a;\n  line-height: 1.5;\n}\n\n.tooltipx[_ngcontent-%COMP%]:hover   .tooltiptext-custom[_ngcontent-%COMP%] {\n  visibility: visible;\n}\n.pcs[_ngcontent-%COMP%]:after {\n  content: " pcs";\n}\n.cur[_ngcontent-%COMP%]:before {\n  content: "$";\n}\n.per[_ngcontent-%COMP%]:after {\n  content: "%";\n}\n*[_ngcontent-%COMP%] {\n  box-sizing: border-box;\n}\nbody[_ngcontent-%COMP%] {\n  padding: 0.2em 2em;\n}\ntable[_ngcontent-%COMP%] {\n  width: 100%;\n}\ntable[_ngcontent-%COMP%]   th[_ngcontent-%COMP%] {\n  text-align: left;\n  border-bottom: 1px solid #ccc;\n}\ntable[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%] {\n  padding: 0.4em;\n  font-family: "Poppins", "Roboto", "Arial", sans-serif;\n  font-weight: 400;\n}\ntable.fold-table[_ngcontent-%COMP%]    > tbody[_ngcontent-%COMP%]    > tr.view[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], table.fold-table[_ngcontent-%COMP%]    > tbody[_ngcontent-%COMP%]    > tr.view[_ngcontent-%COMP%]   th[_ngcontent-%COMP%] {\n  cursor: pointer;\n}\ntable.fold-table[_ngcontent-%COMP%]    > tbody[_ngcontent-%COMP%]    > tr.view[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child, table.fold-table[_ngcontent-%COMP%]    > tbody[_ngcontent-%COMP%]    > tr.view[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child {\n  position: relative;\n  padding-left: 20px;\n}\ntable.fold-table[_ngcontent-%COMP%]    > tbody[_ngcontent-%COMP%]    > tr.view[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child:before, table.fold-table[_ngcontent-%COMP%]    > tbody[_ngcontent-%COMP%]    > tr.view[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child:before {\n  position: absolute;\n  top: 50%;\n  left: 5px;\n  width: 9px;\n  height: 16px;\n  margin-top: -8px;\n  font: 16px fontawesome;\n  color: #999;\n  content: "\\f0d7";\n  transition: all 0.3s ease;\n}\ntable.fold-table[_ngcontent-%COMP%]    > tbody[_ngcontent-%COMP%]    > tr.view[_ngcontent-%COMP%]:hover {\n  background: #eee;\n}\ntable.fold-table[_ngcontent-%COMP%]    > tbody[_ngcontent-%COMP%]    > tr.view.open[_ngcontent-%COMP%] {\n  background: #3ea9f5;\n  color: white;\n}\ntable.fold-table[_ngcontent-%COMP%]    > tbody[_ngcontent-%COMP%]    > tr.view.open[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child:before, table.fold-table[_ngcontent-%COMP%]    > tbody[_ngcontent-%COMP%]    > tr.view.open[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child:before {\n  transform: rotate(-180deg);\n  color: white;\n}\ntable.fold-table[_ngcontent-%COMP%]    > tbody[_ngcontent-%COMP%]    > tr.fold[_ngcontent-%COMP%] {\n  display: none;\n}\ntable.fold-table[_ngcontent-%COMP%]    > tbody[_ngcontent-%COMP%]    > tr.fold.open[_ngcontent-%COMP%] {\n  display: table-row;\n}\n.fold-content[_ngcontent-%COMP%] {\n  padding: 0.5em;\n}\n.fold-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%] {\n  margin-top: 0;\n}\n.fold-content[_ngcontent-%COMP%]    > table[_ngcontent-%COMP%] {\n  border: 1px solid #ccc;\n}\n.btn_in_accordion_table.open[_ngcontent-%COMP%] {\n  color: #ffffff !important;\n}']}),e})();var E=c(31449);const Y=[{path:"",component:S}];let q=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[b.Bz.forChild(Y),g.ez,E.m,d.aw,b.Bz]}),e})()}}]);