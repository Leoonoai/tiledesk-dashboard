"use strict";(self.webpackChunkchat21=self.webpackChunkchat21||[]).push([[7121],{37121:(Y,M,s)=>{s.r(M),s.d(M,{AutomationCreateModule:()=>Ut});var f=s(69808),P=s(54132),x=s(82349),v=s(44034),y=s(35243),g=s(48616),t=s(5e3),R=s(47423),I=s(51062);function F(n,i){1&n&&(t.TgZ(0,"div",18),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SorryYourCSVFileContainsMoreThan3000Contacts")," "))}function j(n,i){1&n&&(t.TgZ(0,"div",18),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SorryThereWasProblemUploadingTheFile")," "))}function J(n,i){1&n&&(t.TgZ(0,"div",19),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"ContactsUploadedSuccessfully")," "))}function V(n,i){if(1&n&&(t.TgZ(0,"div",15),t.YNc(1,F,3,3,"div",16),t.YNc(2,j,3,3,"div",16),t.YNc(3,J,3,3,"div",17),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",!0===e.contactsGreaterThen3000&&!1===e.parse_err),t.xp6(1),t.Q6J("ngIf",!1===e.contactsGreaterThen3000&&!0===e.parse_err),t.xp6(1),t.Q6J("ngIf",!1===e.contactsGreaterThen3000&&!1===e.parse_err)}}function Q(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div",20)(1,"input",21),t.NdJ("change",function(a){t.CHM(e);const r=t.oxw();return t.KtG(r.fileChangeUploadCSV(a))}),t.qZA(),t.TgZ(2,"label",22),t._uU(3),t.ALo(4,"translate"),t.qZA()()}2&n&&(t.xp6(3),t.hij(" ",t.lcZ(4,1,"FaqPage.ChooseFile")," "))}function H(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",26),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.onCloseBaseModal())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Close")," "))}function W(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",27),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.onDone())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"Continue")," "))}function q(n,i){if(1&n&&(t.TgZ(0,"div",23),t.YNc(1,H,3,3,"button",24),t.YNc(2,W,3,3,"button",25),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",!0===e.parse_err||!0===e.contactsGreaterThen3000),t.xp6(1),t.Q6J("ngIf",!1===e.parse_err&&!1===e.contactsGreaterThen3000)}}let G=(()=>{class n{constructor(e,o,a,r,c){this.data=e,this.dialogRef=o,this.logger=a,this.automationsService=r,this.notify=c,this.displayAfterUploadFromCSVSection=!1,this.csvColumnsDelimiter=";",this.contactsGreaterThen3000=!1,this.logger.log("[AUTOMATION-UPLOAD-CSV] data",e),this.csvOutput=e.csvOutput,this.selected_template_name=e.selected_template_name+".csv"}ngOnInit(){}downlaodCSV(){this.downloadFile(this.csvOutput,this.selected_template_name)}downloadFile(e,o){const a=new Blob(["\ufeff"+e],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),c=URL.createObjectURL(a);-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&r.setAttribute("target","_blank"),r.setAttribute("href",c),r.setAttribute("download",o),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}fileChangeUploadCSV(e){this.displayAfterUploadFromCSVSection=!0;const o=e.target.files;if(o.length>0){const a=o[0];if(this.file=o[0],"text/csv"!==this.file.type)return this.onCloseBaseModal(),void this.notify.presenModalAttachmentFileTypeNotSupported();this.logger.log("[AUTOMATION-UPLOAD-CSV] fileChangeUploadCSV file:",this.file);const r=new FileReader;r.onerror=c=>{this.logger.error("[AUTOMATION-UPLOAD-CSV] Errore nella lettura del file:",c),this.parse_err=!0},r.onload=()=>{this.parsedData=this.parseCSV(r.result),this.logger.log("[AUTOMATION-UPLOAD-CSV] parsedData ",this.parsedData),this.logger.log("[AUTOMATION-UPLOAD-CSV] parsedData length",this.parsedData.length),this.parse_err=!1,this.parsedData.length>3e3&&(this.contactsGreaterThen3000=!0)},r.readAsText(a)}}parseCSV(e){const o=e.split(/\r?\n/).filter(c=>""!==c.trim());if(0===o.length)return[];const a=o[0].split(";").map(c=>c.trim());return o.slice(1).map(c=>{const u=c.split(";").map(h=>h.trim()),_={};return a.forEach((h,l)=>{_[h]=u[l]||""}),_})}onDone(){this.dialogRef.close({file:this.file,parsedData:this.parsedData})}onCloseBaseModal(){this.dialogRef.close()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(x.WI),t.Y36(x.so),t.Y36(g.m),t.Y36(y.r),t.Y36(v.c))},n.\u0275cmp=t.Xpm({type:n,selectors:[["appdashboard-automation-upload-csv"]],decls:25,vars:13,consts:[[1,"m-header"],["mat-dialog-title",""],[1,"m-top-right-icon"],[1,"material-icons-outlined",3,"click"],["mat-dialog-content",""],[1,"info-container"],[1,"material-icons-outlined","info-icon"],[1,"info-text"],[1,"download---example-csv-wpr"],[1,"download--example-csv",3,"click"],[2,"display","block","color","#D06079"],["class","after-upload-msg-container",4,"ngIf"],["mat-dialog-actions","",2,"justify-content","center"],["class","btn-before-upload-wpr",4,"ngIf"],["class","btn-after-upload-wpr",4,"ngIf"],[1,"after-upload-msg-container"],["class","error",4,"ngIf"],["class","success",4,"ngIf"],[1,"error"],[1,"success"],[1,"btn-before-upload-wpr"],["name","fileChangeUploadCSV","id","fileChangeUploadCSV","type","file","accept",".csv",1,"inputfile",2,"display","inline",3,"change"],["for","fileChangeUploadCSV",1,"btn","btn-tdblu-no-boxshadow",2,"height","36px","padding","8px 20px !important"],[1,"btn-after-upload-wpr"],["class","mat-dialog-close-btn","mat-button","",3,"click",4,"ngIf"],["class","mat-dialog-ok-btn","mat-button","",3,"click",4,"ngIf"],["mat-button","",1,"mat-dialog-close-btn",3,"click"],["mat-button","",1,"mat-dialog-ok-btn",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",2)(5,"span",3),t.NdJ("click",function(){return o.onCloseBaseModal()}),t._uU(6," close "),t.qZA()()(),t.TgZ(7,"div",4)(8,"div",5)(9,"i",6),t._uU(10,"help_outline"),t.qZA(),t.TgZ(11,"div",7)(12,"div",8)(13,"span"),t._uU(14),t.ALo(15,"translate"),t.qZA(),t.TgZ(16,"button",9),t.NdJ("click",function(){return o.downlaodCSV()}),t._uU(17),t.qZA(),t.TgZ(18,"span",10),t._uU(19),t.ALo(20,"translate"),t.qZA()()()()(),t.YNc(21,V,4,3,"div",11),t.TgZ(22,"div",12),t.YNc(23,Q,5,3,"div",13),t.YNc(24,q,3,2,"div",14),t.qZA()),2&e&&(t.xp6(2),t.hij(" ",t.lcZ(3,7,"ImportFromCSV")," "),t.xp6(12),t.hij(" ",t.lcZ(15,9,"AsStartingPointYouCanDownloadTheCSV")," "),t.xp6(3),t.hij(" ",o.selected_template_name," "),t.xp6(2),t.hij(" ",t.lcZ(20,11,"PleaseNoteThatYouCanUploadMax3000Contacts"),""),t.xp6(2),t.Q6J("ngIf",!0===o.displayAfterUploadFromCSVSection),t.xp6(2),t.Q6J("ngIf",!1===o.displayAfterUploadFromCSVSection),t.xp6(1),t.Q6J("ngIf",!0===o.displayAfterUploadFromCSVSection))},dependencies:[f.O5,x.uh,x.xY,x.H8,R.lW,I.X$],styles:[".m-header[_ngcontent-%COMP%] {\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n}\n\n.info-container[_ngcontent-%COMP%] {\n  display: flex;\n  flex-direction: row;\n  padding: 12px 15px;\n  border-radius: 4px;\n  background-color: rgba(215, 235, 250, 0.431372549);\n}\n\n.info-container[_ngcontent-%COMP%]   .info-icon[_ngcontent-%COMP%] {\n  margin-right: 8px;\n  font-size: 20px;\n}\n\n.info-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%] {\n  margin-bottom: 0px;\n}\n\n.inputfile[_ngcontent-%COMP%] {\n  width: 0.1px;\n  height: 0.1px;\n  opacity: 0;\n  overflow: hidden;\n  position: absolute;\n  z-index: -1;\n}\n\n.mat-dialog-ok-btn[_ngcontent-%COMP%] {\n  background-color: var(--blue-light);\n  color: #fff;\n}\n\n.mat-dialog-close-btn[_ngcontent-%COMP%] {\n  background-color: #647491;\n  color: #fff;\n}\n\n.download--example-csv-wpr[_ngcontent-%COMP%] {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n}\n\n.download--example-csv[_ngcontent-%COMP%] {\n  border: unset;\n  background-color: transparent;\n  color: var(--only-text-btn-color);\n  padding: 0px 3px;\n  border-radius: 4px;\n}\n\n.download--example-csv[_ngcontent-%COMP%]:hover {\n  background-color: var(--only-text-btn-hover-background);\n}\n\n.after-upload-msg-container[_ngcontent-%COMP%] {\n  text-align: center;\n  margin-top: 6px;\n  font-size: 14px;\n  font-weight: 400;\n}\n\n.after-upload-msg-container[_ngcontent-%COMP%]    > div.success[_ngcontent-%COMP%] {\n  color: #73AF55;\n}\n\n.after-upload-msg-container[_ngcontent-%COMP%]    > div.error[_ngcontent-%COMP%] {\n  color: #D06079;\n}"]}),n})();var K=s(87341),X=s(66888),$=s(7625),tt=s(8929),et=s(22313),z=s(24376),Z=s(93075),C=s(32075),nt=s(30091),ot=s(78558);let at=(()=>{class n{transform(e){if(!e)return"";let o=e.replace(/~([^~\n]+)~/g,"~~$1~~");return o=o.replace(/\r?\n/g,"  \n"),o}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=t.Yjl({name:"waToMarkdown",type:n,pure:!0}),n})(),it=(()=>{class n{transform(e){return e?e.replace(/\[(body|header|buttons)_\d+\]/g,a=>`<span class="csv-col-label">${a}</span>`):e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=t.Yjl({name:"formatColLabels",type:n,pure:!0}),n})();function rt(n,i){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ( ",null==e.parsedCsvData?null:e.parsedCsvData.length," ) ")}}function st(n,i){1&n&&(t.TgZ(0,"div",28)(1,"div"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div"),t._uU(5),t.ALo(6,"translate"),t.qZA()()),2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,2,"ToStartBroadcast")," "),t.xp6(3),t.hij(" ",t.lcZ(6,4,"HereYouWillSeePreviewOfYourContacts")," "))}function lt(n,i){if(1&n&&(t.TgZ(0,"th",37),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e)}}function ct(n,i){if(1&n&&(t.TgZ(0,"td",38),t._uU(1),t.qZA()),2&n){const e=i.$implicit,o=t.oxw().$implicit;t.xp6(1),t.Oqu(e[o])}}function pt(n,i){1&n&&(t.ynx(0,34),t.YNc(1,lt,2,1,"th",35),t.YNc(2,ct,2,1,"td",36),t.BQk()),2&n&&t.Q6J("matColumnDef",i.$implicit)}function dt(n,i){1&n&&t._UZ(0,"tr",39)}function mt(n,i){1&n&&t._UZ(0,"tr",40)}function ut(n,i){if(1&n&&(t.TgZ(0,"div",29)(1,"table",30),t.YNc(2,pt,3,1,"ng-container",31),t.YNc(3,dt,1,0,"tr",32),t.YNc(4,mt,1,0,"tr",33),t.qZA()()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("dataSource",e.parsedCsvData),t.xp6(1),t.Q6J("ngForOf",e.displayedColumns),t.xp6(1),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns)}}function gt(n,i){1&n&&(t.TgZ(0,"div",41)(1,"div",42),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"NoTemplateSelected")," "))}function ht(n,i){if(1&n&&(t._UZ(0,"span",49),t.ALo(1,"marked"),t.ALo(2,"waToMarkdown"),t.ALo(3,"htmlEntitiesEncode")),2&n){const e=t.oxw(2);t.Q6J("innerHTML",t.lcZ(1,1,t.lcZ(2,3,t.lcZ(3,5,null==e.header_component?null:e.header_component.text))),t.oJD)}}function _t(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"span")(1,"img",53),t.NdJ("error",function(a){t.CHM(e);const r=t.oxw(2);return t.KtG(r.onHeaderImageError(a))}),t.qZA()()}if(2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("src",e.header_params[0].image.link,t.LSH)}}function ft(n,i){1&n&&(t.TgZ(0,"span")(1,"div",54)(2,"p"),t._uU(3,"PDF"),t.qZA()()())}function xt(n,i){1&n&&(t.TgZ(0,"span")(1,"div",55),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"Location")," "))}function Ct(n,i){1&n&&(t.TgZ(0,"span",61),t._uU(1,"open_in_new"),t.qZA())}function At(n,i){1&n&&(t.TgZ(0,"span",62),t._uU(1,"phone"),t.qZA())}function vt(n,i){if(1&n&&(t.TgZ(0,"button",58),t.YNc(1,Ct,2,0,"span",59),t.YNc(2,At,2,0,"span",60),t._uU(3),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.Q6J("ngIf","URL"===e.type),t.xp6(1),t.Q6J("ngIf","PHONE_NUMBER"===e.type),t.xp6(1),t.hij(" ",e.text," ")}}function bt(n,i){if(1&n&&(t.TgZ(0,"div",56),t.YNc(1,vt,4,3,"button",57),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.buttons_component.buttons)}}function Tt(n,i){if(1&n&&(t.TgZ(0,"button",66)(1,"span",67),t._uU(2),t.qZA()()),2&n){const e=i.$implicit;t.xp6(2),t.Oqu(e.text)}}function Ot(n,i){if(1&n&&(t.TgZ(0,"div",63)(1,"div",64),t.YNc(2,Tt,3,1,"button",65),t.qZA()()),2&n){const e=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",e.buttons_component.buttons)}}function Et(n,i){if(1&n&&(t.TgZ(0,"div",43)(1,"div",44)(2,"div",45)(3,"div",46),t.YNc(4,ht,4,7,"span",47),t.YNc(5,_t,2,1,"span",19),t.YNc(6,ft,4,0,"span",19),t.YNc(7,xt,4,3,"span",19),t.qZA(),t.TgZ(8,"div",48),t._UZ(9,"span",49),t.ALo(10,"formatColLabels"),t.ALo(11,"marked"),t.ALo(12,"waToMarkdown"),t.qZA(),t.TgZ(13,"div",50),t._UZ(14,"span",49),t.ALo(15,"marked"),t.ALo(16,"waToMarkdown"),t.ALo(17,"htmlEntitiesEncode"),t.qZA(),t.YNc(18,bt,2,1,"div",51),t.qZA(),t.YNc(19,Ot,3,1,"div",52),t.qZA()()),2&n){const e=t.oxw();t.xp6(4),t.Q6J("ngIf","TEXT"===(null==e.header_component?null:e.header_component.format)),t.xp6(1),t.Q6J("ngIf","IMAGE"===(null==e.header_component?null:e.header_component.format)),t.xp6(1),t.Q6J("ngIf","DOCUMENT"===(null==e.header_component?null:e.header_component.format)),t.xp6(1),t.Q6J("ngIf","LOCATION"===(null==e.header_component?null:e.header_component.format)),t.xp6(2),t.Q6J("innerHTML",t.lcZ(10,8,t.lcZ(11,10,t.lcZ(12,12,null==e.body_component?null:e.body_component.text))),t.oJD),t.xp6(5),t.Q6J("innerHTML",t.lcZ(15,14,t.lcZ(16,16,t.lcZ(17,18,null==e.footer_component?null:e.footer_component.text))),t.oJD),t.xp6(4),t.Q6J("ngIf",e.buttons_component&&("URL"===e.buttons_component.buttons[0].type||"PHONE_NUMBER"===e.buttons_component.buttons[0].type)),t.xp6(1),t.Q6J("ngIf",e.buttons_component&&"QUICK_REPLY"===e.buttons_component.buttons[0].type)}}const wt=function(n){return{"button--only--text-disabled":n}},N=s(35226);let yt=(()=>{class n{constructor(e,o,a,r,c,u,_,h,l){this.auth=e,this.logger=o,this.automationsService=a,this.router=r,this.roleService=c,this.dialog=u,this.location=_,this.sanitizer=h,this.translate=l,this.unsubscribe$=new tt.xQ,this.templates_list=[],this.body_params=[],this.header_params=[],this.buttons_params=[],this.displayedColumns=[],this.fakeTmplt=[{name:"promo_mensile",parameter_format:"POSITIONAL",components:[{type:"HEADER",format:"IMAGE",example:{header_handle:["https://scontent.whatsapp.net/v/t61.29466-34/343725253_729228922313210_6754026546673493433_n.jpg?ccb=1-7&_nc_sid=8b1bef&_nc_ohc=uJnqYx8IR-AQ7kNvwHJEtFo&_nc_oc=Adk0wVT4Fg9gn4YCFxTKFPcWfw4VOCmdbcjTtMLwxdQGJnGyOyAMtG1zCMiqJ9NBFWM&_nc_zt=3&_nc_ht=scontent.whatsapp.net&edm=AH51TzQEAAAA&_nc_gid=JBHqlsUw1l4jymRX24x1TA&oh=01_Q5Aa2AGWof5sqqX3V_ZQ8hd2B5eMNTHObB04o-LSLdMc6rghRg&oe=68BADCB3"]}},{type:"BODY",text:"Ciao *{{1}}*,\nIn offerta per i nostri clienti, solo per il mese di {{2}}\n\n*{{3}}*\na soli \u20ac _{{4}}_ invece di \u20ac ~{{5}}~",example:{body_text:[["Marco","Maggio","JALAPENOS CHEDDAR 5PZX1KG(CGM)","24,99","29,99"]]}},{type:"FOOTER",text:"Scopri le altre offerte su www.eurofoodservice.it"},{type:"BUTTONS",buttons:[{type:"URL",text:"Acquista ora!",url:"https://www.eurofoodservice.it/it/ultimi-arrivi/10628-jalapenos-cheddar-5pzx1kgcgm.html{{1}}",example:["https://www.eurofoodservice.it/it/ultimi-arrivi/10628-jalapenos-cheddar-5pzx1kgcgm.html?user=fake0b33d91d"]}]}],language:"it",status:"APPROVED",category:"MARKETING",id:"729228918979877"},{name:"codice_sconto_2",parameter_format:"POSITIONAL",components:[{type:"HEADER",format:"TEXT",text:"Codice promozionale"},{type:"BODY",text:"Ciao {{1}}, solo per te un codice sconto del *{{2}}%* su tutto il nostro catalogo.\n\nUsa il codice {{3}} in fase di acquisto.\n\n*Codice utilizzabile per un solo acquisto",example:{body_text:[["Marco","30%","SUMMER2023"]]}},{type:"FOOTER",text:"Non ti interessa? Tocca Interrompi promozioni"},{type:"BUTTONS",buttons:[{type:"QUICK_REPLY",text:"Grazie!"},{type:"QUICK_REPLY",text:"Vai ai preferiti"},{type:"QUICK_REPLY",text:"Interrompi promozioni"}]}],language:"it",status:"APPROVED",category:"MARKETING",id:"266717792558792"},{name:"fine_supporto",parameter_format:"POSITIONAL",components:[{type:"BODY",text:"Ciao da Assi.Cura,\nCome nostro cliente hai diritto ad uno sconto del 10% sulla tua prossima polizza.\nA cosa sei interessato?"},{type:"BUTTONS",buttons:[{type:"QUICK_REPLY",text:"Polizza Auto"},{type:"QUICK_REPLY",text:"Polizza Vita"},{type:"QUICK_REPLY",text:"Polizza Moto"},{type:"QUICK_REPLY",text:"Polizza Famiglia"},{type:"QUICK_REPLY",text:"Polizza Casa"}]}],language:"it",status:"APPROVED",category:"MARKETING",sub_category:"CUSTOM",id:"509677821785781"},{name:"tiledesk_scheduler",parameter_format:"POSITIONAL",components:[{type:"HEADER",format:"IMAGE",example:{header_handle:["https://scontent.whatsapp.net/v/t61.29466-34/394168429_23901956129448434_7220288921085766441_n.png?ccb=1-7&_nc_sid=8b1bef&_nc_ohc=JhAJccIAtasQ7kNvwFPd1fn&_nc_oc=AdkObNiva_peHoapo7PL6v-NExbMgqym25OIMj3NVQPxIfASPejnb8j2Seu8ZxC8elA&_nc_zt=3&_nc_ht=scontent.whatsapp.net&edm=AH51TzQEAAAA&_nc_gid=JBHqlsUw1l4jymRX24x1TA&oh=01_Q5Aa2AEuBiNV1U__PELmQsuD34cQr-7jv4TcHF7PQMXrkY4Qsg&oe=68BAC07F"]}},{type:"BODY",text:"*Operazione Scheduler*\n\nSe hai ricevuto questo messaggio vuol dire che da oggi \xe8 possibile utilizzare Whatsapp con Tiledesk per inviare campagne utilizzando lo schema Scheduler-Worker!\nPuoi darci un riscontro rispondendo a questo messaggio."},{type:"FOOTER",text:"_Il team di Tiledesk_"},{type:"BUTTONS",buttons:[{type:"QUICK_REPLY",text:"Ho ricevuto il messaggio"}]}],language:"it",status:"APPROVED",category:"MARKETING",id:"23901956106115103"},{name:"store_fisico",parameter_format:"POSITIONAL",components:[{type:"HEADER",format:"LOCATION"},{type:"BODY",text:"Le offerte imperdibile proseguono nel nostro store fisico.\nVieni a trovarci a in \n\u{1f4cd}_via Bruxelles, 30 - Z.I. Soleto, Lecce, Italia_"}],language:"it",status:"APPROVED",category:"MARKETING",id:"810382583422764"},{name:"giacenza_ordine",parameter_format:"POSITIONAL",components:[{type:"BODY",text:"Ciao {{1}},\nabbiamo provato a consegnarti un pacco, ma non ci siamo riusciti.\nIl pacco relativo all'ordine *{{2}}* \xe8 adesso in giacenza presso il nostro magazzino.\nSe vuoi riprogrammare la consegna clicca sul bottone qui sotto.",example:{body_text:[["John","123456789"]]}},{type:"FOOTER",text:"Il team di Tiledesk"},{type:"BUTTONS",buttons:[{type:"QUICK_REPLY",text:"Riprogramma ora"}]}],language:"it",status:"APPROVED",category:"UTILITY",id:"909025190948975"},{name:"codice_sconto",parameter_format:"POSITIONAL",components:[{type:"HEADER",format:"TEXT",text:"Codice promozionale"},{type:"BODY",text:"Ciao {{1}}, solo per te un codice sconto del *{{2}}%* su tutto il nostro catalogo.\n\nUsa il codice {{3}} in fase di acquisto.\n\n*Codice utilizzabile per un solo acquisto",example:{body_text:[["John","30","WINTER30"]]}},{type:"FOOTER",text:"Non ti interessa? Tocca Interrompi promozioni"},{type:"BUTTONS",buttons:[{type:"QUICK_REPLY",text:"Non mi interessa"}]}],language:"it",status:"APPROVED",category:"MARKETING",id:"241243738551710"},{name:"issue_resolution",parameter_format:"POSITIONAL",components:[{type:"HEADER",format:"TEXT",text:"Hi {{1}}",example:{header_text:["Marco"]}},{type:"BODY",text:"were we able to solve your problem about {{1}}?",example:{body_text:[["the use of templates"]]}},{type:"FOOTER",text:"The Tiledesk Team"},{type:"BUTTONS",buttons:[{type:"QUICK_REPLY",text:"Yes, thank you!"},{type:"QUICK_REPLY",text:"No"}]}],language:"en_US",status:"REJECTED",category:"UTILITY",id:"188981247423476"},{name:"promo_mensile_2",parameter_format:"POSITIONAL",components:[{type:"HEADER",format:"IMAGE",example:{header_handle:["https://scontent.whatsapp.net/v/t61.29466-34/347084442_622522489760178_4258564200183192902_n.jpg?ccb=1-7&_nc_sid=8b1bef&_nc_ohc=cSqfcr2WBDgQ7kNvwGASVqI&_nc_oc=AdkElw6eOHJw6r3-mXIDSq0VNUfhUPPmJEA1IKvly3C-dGF2p8Z0CY6U3SOduEHN5NI&_nc_zt=3&_nc_ht=scontent.whatsapp.net&edm=AH51TzQEAAAA&_nc_gid=JBHqlsUw1l4jymRX24x1TA&oh=01_Q5Aa2AGC6vqLsHdCmgcV8SRTaCWHzwS2OvFv6jPktRJHnArJTQ&oe=68BACEA8"]}},{type:"BODY",text:"Ciao *{{1}}*,\nIn offerta per i nostri clienti, solo per il mese di {{2}}\n\n*{{3}}*\na soli \u20ac _{{4}}_ invece di \u20ac ~{{5}}~",example:{body_text:[["Marco","Maggio","JALAPENOS CHEDDAR 5PZX1KG(CGM)","24,99","29,99"]]}},{type:"FOOTER",text:"Scopri le altre offerte su www.eurofoodservice.it"},{type:"BUTTONS",buttons:[{type:"URL",text:"Acquista ora!",url:"https://www.eurofoodservice.it/{{1}}",example:["https://www.eurofoodservice.it/it/ultimi-arrivi/10628-jalapenos-cheddar-5pzx1kgcgm.html?user=marco123456"]},{type:"PHONE_NUMBER",text:"Ordina per telefono",phone_number:"+390836521511"}]}],language:"it",status:"APPROVED",category:"MARKETING",id:"622522486426845"},{name:"test_marketing",parameter_format:"POSITIONAL",components:[{type:"HEADER",format:"IMAGE",example:{header_handle:["https://scontent.whatsapp.net/v/t61.29466-34/347247516_769112138286827_1046197383828542239_n.jpg?ccb=1-7&_nc_sid=8b1bef&_nc_ohc=JLdTY7wWWakQ7kNvwGr0HrO&_nc_oc=AdnHJplQTgDzAyqsfb0jK3I1vqKPU6oowaSLmRJ06HEFpg8-8lQRh81Ds0RJkWn6Wm8&_nc_zt=3&_nc_ht=scontent.whatsapp.net&edm=AH51TzQEAAAA&_nc_gid=JBHqlsUw1l4jymRX24x1TA&oh=01_Q5Aa2AFq2q0aymJrt-NCEbvTJqLuNPvfbLciczJrEYbW4I7uag&oe=68BACC50"]}},{type:"BODY",text:"In offerta solo per questa settimana {{1}} al prezzo di {{2}}!\nValida solo per i clienti Eurofood.",example:{body_text:[["Croissant Superfarcito al Cioccolato 3x1","3\u20ac"]]}},{type:"FOOTER",text:"www.eurofoodservice.it"},{type:"BUTTONS",buttons:[{type:"URL",text:"Acquista subito",url:"https://www.eurofoodservice.it/it/ultimi-arrivi/11151-croissant-superfarcito-cioccolato-56pzx100grbu.html"}]}],language:"it",status:"APPROVED",category:"MARKETING",id:"769112134953494"},{name:"fattura_acquisto",parameter_format:"POSITIONAL",components:[{type:"HEADER",format:"DOCUMENT",example:{header_handle:["https://scontent.whatsapp.net/v/t61.29466-34/346935368_567293045520623_7846722721882459788_n.pdf?ccb=1-7&_nc_sid=8b1bef&_nc_ohc=DJQNRD0c5WMQ7kNvwG6AeO2&_nc_oc=Adke1lTi_2a3YehCIIkVMRRyWVzFE1HvjCYSe4DwgYKRsSeS-dMKBk7CrVcHJhemrA0&_nc_zt=3&_nc_ht=scontent.whatsapp.net&edm=AH51TzQEAAAA&_nc_gid=JBHqlsUw1l4jymRX24x1TA&oh=01_Q5Aa2AGL_1Gbn7cL8az8SWgmP9oMo39PoAhcrfHK01gWQ4-Xlg&oe=68BAC7A3"]}},{type:"BODY",text:"Ciao *{{1}}*,\n\xe8 disponibile la fattura di vendita numero *{{2}}*\nriferita all'ordine numero *{{3}}* del _{{4}}_\n\nA presto!",example:{body_text:[["Marco","23F0064772","EVYCKBZZG","17/05/2023"]]}},{type:"FOOTER",text:"Il team di Eurofood"},{type:"BUTTONS",buttons:[{type:"PHONE_NUMBER",text:"Problemi con la fattura?",phone_number:"+393484506627"}]}],language:"it",status:"APPROVED",category:"UTILITY",id:"566707308912530"},{name:"hello_world",parameter_format:"POSITIONAL",components:[{type:"HEADER",format:"TEXT",text:"Hello World"},{type:"BODY",text:"Welcome and congratulations!! This message demonstrates your ability to send a WhatsApp message notification from the Cloud API, hosted by Meta. Thank you for taking the time to test with us."},{type:"FOOTER",text:"WhatsApp Business Platform sample message"}],language:"en_US",status:"APPROVED",category:"UTILITY",id:"1283803345820684"}]}ngOnInit(){this.roleService.checkRoleForCurrentProject("automations"),this.getBrowserVersion(),this.listenSidebarIsOpened(),this.getWATemplates(),this.getCurrentProject()}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}getCurrentProject(){this.auth.project_bs.pipe((0,$.R)(this.unsubscribe$)).subscribe(e=>{e&&(this.projectId=e._id,this.logger.log("[AUTOMATION-CREATE] - projectId ",this.projectId))})}downloadFile(e,o){const a=new Blob(["\ufeff"+e],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),c=URL.createObjectURL(a),u=-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome");this.logger.log("[AUTOMATION-CREATE] isSafariBrowser ",u),u&&r.setAttribute("target","_blank"),r.setAttribute("href",c),r.setAttribute("download",o),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}getWATemplates(){this.automationsService.getWATemplates().subscribe(e=>{this.logger.log("[AUTOMATION-CREATE] GET WA TEMPLATES templates ",e),this.templates_list=e},e=>{this.logger.error("[AUTOMATION-CREATE] - GET WA TEMPLATES - ERROR: ",e),this.logger.log(e.error.message),e.error.message.includes("WhatsApp not installed for the project_id")&&(this.logger.log("[AUTOMATION-CREATE] - WA not installed"),this.presentDialogWANotInstalledFoTheCurrentProject())},()=>{this.logger.log("[AUTOMATION-CREATE] - GET WA TEMPLATES * COMPLETE *")})}presentDialogWANotInstalledFoTheCurrentProject(){N.fire({title:this.translate.instant("WhatsAppNotConfigured"),text:this.translate.instant("UnableToCreateBroadcastWAIsNotInstalled"),icon:"warning",showCloseButton:!0,showCancelButton:!0,showConfirmButton:!0,showDenyButton:!1,confirmButtonText:this.translate.instant("OnboardPage.Configure"),cancelButtonText:this.translate.instant("Cancel"),focusConfirm:!1,reverseButtons:!0}).then(e=>{e.isConfirmed&&this.router.navigate(["project/"+this.projectId+"/integrations"],{queryParams:{name:"whatsapp"}})})}onSelectTemplate(){this.selected_template=this.templates_list.find(o=>o.name===this.templateName),this.logger.log("[AUTOMATION-CREATE] onSelectTemplate selected_template",this.selected_template),this.selected_template_name=this.selected_template.name,this.selected_template_lang=this.selected_template.language,this.logger.log("[AUTOMATION-CREATE] onSelectTemplate selected_template_name",this.selected_template_name),this.csvOutput=this.generateCSVFromWhatsAppTemplate(this.selected_template,["3931234567"]),this.logger.log("[AUTOMATION-CREATE] csvOutput",this.csvOutput),this.createTemplatePreview()}createTemplatePreview(){var e,o,a,r,c,u,_;this.header_params=[],this.body_params=[],this.buttons_params=[],this.previsioning_url=null;let h=JSON.parse(JSON.stringify(this.selected_template));if(this.header_component=h.components.find(l=>"HEADER"===l.type),this.logger.log("[AUTOMATION-CREATE] header_component",this.header_component),this.body_component=h.components.find(l=>"BODY"===l.type),this.logger.log("[AUTOMATION-CREATE] body_component",this.body_component),this.footer_component=h.components.find(l=>"FOOTER"===l.type),this.logger.log("[AUTOMATION-CREATE] footer_component",this.footer_component),this.buttons_component=h.components.find(l=>"BUTTONS"===l.type),this.logger.log("[AUTOMATION-CREATE] footer_component",this.buttons_component),this.buttons_component&&(this.url_button_component=this.buttons_component.buttons.find(l=>"URL"===l.type)),this.header_component)if(this.header_component_temp=JSON.parse(JSON.stringify(this.header_component)),"TEXT"===this.header_component.format)((null===(e=this.header_component.example)||void 0===e?void 0:e.header_text)||[]).forEach((d,m)=>{const b=new RegExp("\\{\\{"+(m+1)+"\\}\\}","g");this.header_component.text=(this.header_component.text||"").replace(b,d),this.header_params.push({index:m+1,type:"TEXT",text:d})});else if("IMAGE"===this.header_component.format)((null===(o=this.header_component.example)||void 0===o?void 0:o.header_handle)||[]).forEach((d,m)=>{this.header_params.push({index:m+1,type:"IMAGE",image:{link:d}})});else if("DOCUMENT"===this.header_component.format){const l=(null===(a=this.header_component.example)||void 0===a?void 0:a.header_handle)||[];l.length&&(this.fileUploadAccept=".pdf",this.src=l[0],this.sanitizeUrl(l[0]),l.forEach((d,m)=>{this.header_params.push({index:m+1,type:"DOCUMENT",document:{link:d}})}))}else"LOCATION"===this.header_component.format?this.header_params.push({index:1,type:this.header_component.format,location:{latitude:null,longitude:null,name:null,address:null}}):this.logger.log("[WHATSAPP RECEIVER] Check unrecognized Header: ",this.header_component);if(this.body_component&&((null===(c=null===(r=this.body_component.example)||void 0===r?void 0:r.body_text)||void 0===c?void 0:c[0])||[]).forEach((d,m)=>{const T=new RegExp("\\{\\{"+(m+1)+"\\}\\}","g");this.body_component.text=(this.body_component.text||"").replace(T,`${d} [body_${m}]`),this.body_params.push({index:m+1,type:"text",text:d})}),null!==(_=null===(u=this.url_button_component)||void 0===u?void 0:u.example)&&void 0!==_&&_[0]){const l=this.url_button_component.url||"",d=this.url_button_component.example[0];if(l.includes("{{1}}")){const[m,b]=l.split("{{1}}");let T="";d.startsWith(m)&&d.endsWith(b)&&(T=d.slice(m.length,d.length-b.length)),this.buttons_params=[{index:1,type:"text",text:T}],this.url_button_component.url=l.replace("{{1}}",T);const O=this.buttons_component.buttons.findIndex(S=>"URL"===S.type);O>-1&&(this.buttons_component.buttons[O]=this.url_button_component),this.previsioning_url=this.url_button_component.url}}}sanitizeUrl(e){this.sanitizedUrl=this.sanitizer.bypassSecurityTrustResourceUrl(e)}onHeaderImageError(e){e.target.src=this.header_component.example.header_handle[0]}openUploadCSVDialog(){if(this.logger.log("[AUTOMATION-CREATE] AutomationUploadCsv this.selected_template ",this.selected_template),!this.selected_template)return;const e=this.dialog.open(G,{backdropClass:"cdk-overlay-transparent-backdrop",hasBackdrop:!0,width:"600px",data:{csvOutput:this.csvOutput,selected_template_name:this.selected_template_name}});this.logger.log("[AUTOMATION-CREATE] AutomationUploadCsv "),e.afterClosed().subscribe(o=>{if(this.logger.log("[AUTOMATION-CREATE] AutomationUploadCsv (afterClosed) result : ",o),o){this.csvFile=o.file,this.parsedCsvData=o.parsedData;const a=this.parsedCsvData[0];a&&(this.displayedColumns=Object.keys(a)),this.logger.log("[AUTOMATION-CREATE] AutomationUploadCsv (afterClosed) csvFile : ",this.csvFile),this.logger.log("[AUTOMATION-CREATE] AutomationUploadCsv (afterClosed) parsedCsvData : ",this.parsedCsvData)}})}getBrowserVersion(){this.auth.isChromeVerGreaterThan100.subscribe(e=>{this.isChromeVerGreaterThan100=e})}listenSidebarIsOpened(){this.auth.settingSidebarIsOpned.subscribe(e=>{this.logger.log("[AUTOMATION-CREATE] SETTINGS-SIDEBAR isopened (FROM SUBSCRIPTION) ",e),this.IS_OPEN_SETTINGS_SIDEBAR=e})}generateCSVFromWhatsAppTemplate(e,o){var a,r,c,u,_,h,l,d,m,b,T;const O=[],S=[],A=e.components.find(p=>"HEADER"===p.type),L=e.components.find(p=>"BODY"===p.type),k=(e.components.find(p=>"FOOTER"===p.type),e.components.find(p=>"BUTTONS"===p.type)),D=null!==(r=null===(a=null==L?void 0:L.example)||void 0===a?void 0:a.body_text)&&void 0!==r?r:[[]],E=null==A?void 0:A.example,U=null!==(_=null===(u=null===(c=null==k?void 0:k.buttons)||void 0===c?void 0:c[0])||void 0===u?void 0:u.example)&&void 0!==_?_:[];if(O.push("phone_number"),A&&O.push("header_0"),D.length>0)for(let p=0;p<D[0].length;p++)O.push(`body_${p}`);U.length>0&&O.push("buttons_0");for(let p=0;p<o.length;p++){const w=[];w.push(o[p]),"IMAGE"===(null==A?void 0:A.format)&&(null===(h=null==E?void 0:E.header_handle)||void 0===h?void 0:h[0])?w.push(E.header_handle[0]):"TEXT"===(null==A?void 0:A.format)&&(null===(l=null==E?void 0:E.header_text)||void 0===l?void 0:l[0])?w.push(E.header_text[0]):A&&w.push("");const Rt=null!==(d=D[p])&&void 0!==d?d:[];for(let B=0;B<(null!==(b=null===(m=D[0])||void 0===m?void 0:m.length)&&void 0!==b?b:0);B++)w.push(null!==(T=Rt[B])&&void 0!==T?T:"");U[p]?w.push(U[p]):U[0]&&w.push(U[0]),S.push(w)}return[O.join(";"),...S.map(p=>p.join(";"))].join("\n")}goBack(){this.location.back()}presentDialogBeforeToSendToServer(){this.logger.log("[AUTOMATION-CREATE] SEND TO SERVER selected_template ",this.selected_template),this.selected_template&&N.fire({title:this.translate.instant("AreYouSure"),text:this.translate.instant("ByPressingTheSendButtonYouWillSendTheMessageTo",{contacts_num:this.parsedCsvData.length,template_name:this.selected_template_name}),icon:"warning",showCloseButton:!1,showCancelButton:!0,showConfirmButton:!0,showDenyButton:!1,confirmButtonText:this.translate.instant("Send"),cancelButtonText:this.translate.instant("Cancel"),focusConfirm:!1,reverseButtons:!0}).then(e=>{if(e.isConfirmed){if(!this.csvFile)return;this.logger.log("[AUTOMATION-CREATE] SEND TO SERVER csvFile ",this.csvFile),this.logger.log("[AUTOMATION-CREATE] SEND TO SERVER id_project ",this.projectId),this.logger.log("[AUTOMATION-CREATE] SEND TO SERVER selected_template_lang ",this.selected_template_lang),this.logger.log("[AUTOMATION-CREATE] SEND TO SERVER selected_template_name ",this.selected_template_name);const o=new FormData;o.append("delimiter",";"),o.append("id_project",this.projectId),o.append("template_name",this.selected_template_name),o.append("template_language",this.selected_template_lang),o.append("uploadFile",this.csvFile,this.csvFile.name),this.automationsService.uploadCsv(o).subscribe(a=>{this.logger.log("[AUTOMATION-CREATE] SEND TO SERVER res",a),a&&(this.automation_id=a.automation_id,this.logger.log("[AUTOMATION-CREATE] SEND TO SERVER automation_id",this.automation_id))},a=>{this.logger.error("[AUTOMATION-CREATE] SEND TO SERVER- ERROR ",a),this.logger.error("[AUTOMATION-CREATE] SEND TO SERVER- ERROR ERROR ERROR",a.error.error);let r="";r=this.translate.instant("WhatsApp not configured or missing business_account_id."===a.error.error?"WhatsAppNotConfiguredOrMissingBusinessAccountID":"HoursPage.ErrorOccurred"),N.fire({title:this.translate.instant("Oops")+"!",text:r,icon:"error",showCloseButton:!1,showCancelButton:!1,confirmButtonText:this.translate.instant("Ok")})},()=>{this.logger.log("[AUTOMATION-CREATE] SEND TO SERVER * COMPLETE *"),this.parsedCsvData=void 0,N.fire({title:this.translate.instant("Done")+"!",text:this.translate.instant("TheBroadcastHasStarted"),icon:"success",showCloseButton:!1,showCancelButton:!1,confirmButtonText:this.translate.instant("Ok")}).then(a=>{this.logger.log("[AUTOMATION-CREATE] okpressed")})})}else this.logger.log("[AUTOMATION-CREATE] (else)")})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(K.e),t.Y36(g.m),t.Y36(y.r),t.Y36(P.F0),t.Y36(X.N),t.Y36(x.uw),t.Y36(f.Ye),t.Y36(et.H7),t.Y36(I.sK))},n.\u0275cmp=t.Xpm({type:n,selectors:[["appdashboard-automation-create"]],decls:43,vars:39,consts:[[1,"navbar-brand",2,"z-index","1050","position","relative","padding-left","30px"],[1,"material-icons",2,"vertical-align","middle !important","cursor","pointer",3,"click"],[1,"main-content",2,"padding-top","0px","padding-left","0px","padding-right","5px"],[1,"container-fluid",2,"padding-right","5px","padding-left","25px"],[1,"row"],[1,"col-sm-12"],[1,"card-content"],[1,"b-flex-container"],[1,"b-left-columns-container"],[1,"b-left--columns"],[1,"choose-wa-tmplt-label-and-select-wpr"],[1,"template-select-label"],[1,"select-and-btn-wpr"],["id","template-select","bindLabel","name","bindValue","name",2,"width","250px",3,"clearable","searchable","ngModel","items","placeholder","ngModelChange","change"],[1,"upload-csv-btn-wpr"],[1,"button--only--text",3,"disabled","ngClass","click"],[1,"contacts-columns"],[1,"contacts-columns-header-wpr"],[1,"contacts-columns-header"],[4,"ngIf"],[1,"button-wpr"],[1,"btn","send-wa-btn",3,"disabled","click"],["class","no-file-uploaded",4,"ngIf"],["class","csv-table-scroll-wrapper",4,"ngIf"],[1,"b-right-column"],[1,"preview-template-header"],["class","no-template-selected-container",4,"ngIf"],["id","preview-container","class","preview-container",4,"ngIf"],[1,"no-file-uploaded"],[1,"csv-table-scroll-wrapper"],["mat-table","",1,"custom-csv-table",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"matColumnDef"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],[1,"no-template-selected-container"],[1,"no-template-selected"],["id","preview-container",1,"preview-container"],[1,"inner-preview-container"],[1,"message-cloud"],[1,"header-preview"],[3,"innerHTML",4,"ngIf"],[1,"body-preview"],[3,"innerHTML"],[1,"footer-preview"],["class","call-to-action-preview",4,"ngIf"],["class","message-cloud-buttons-container",4,"ngIf"],[3,"src","error"],[1,"pdf-preview"],[1,"location-preview"],[1,"call-to-action-preview"],["class","btn whatsapp-call-to-action",4,"ngFor","ngForOf"],[1,"btn","whatsapp-call-to-action"],["class","material-icons-outlined call-to-action-icon",4,"ngIf"],["class","material-icons-round call-to-action-icon",4,"ngIf"],[1,"material-icons-outlined","call-to-action-icon"],[1,"material-icons-round","call-to-action-icon"],[1,"message-cloud-buttons-container"],[1,"message-cloud-buttons"],["fill","clear","class","message-cloud-button",4,"ngFor","ngForOf"],["fill","clear",1,"message-cloud-button"],[1,"_2VWlB"]],template:function(e,o){1&e&&(t.TgZ(0,"p",0)(1,"i",1),t.NdJ("click",function(){return o.goBack()}),t._uU(2," keyboard_arrow_left "),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.ALo(5,"translate"),t.qZA()(),t.TgZ(6,"div",2)(7,"div",3)(8,"div",4)(9,"div",5)(10,"div",6)(11,"div",7)(12,"div",8)(13,"div",9)(14,"div",10)(15,"div",11),t._uU(16),t.ALo(17,"translate"),t.qZA(),t.TgZ(18,"div",12)(19,"ng-select",13),t.NdJ("ngModelChange",function(r){return o.templateName=r})("change",function(){return o.onSelectTemplate()}),t.ALo(20,"translate"),t.qZA(),t.TgZ(21,"div",14)(22,"button",15),t.NdJ("click",function(){return o.openUploadCSVDialog()}),t._uU(23),t.ALo(24,"translate"),t.qZA()()()(),t.TgZ(25,"div",16)(26,"div",17)(27,"div",18),t._uU(28),t.ALo(29,"translate"),t.YNc(30,rt,2,1,"span",19),t.qZA(),t.TgZ(31,"div",20)(32,"button",21),t.NdJ("click",function(){return o.presentDialogBeforeToSendToServer()}),t._uU(33),t.ALo(34,"translate"),t.qZA()()(),t.YNc(35,st,7,6,"div",22),t.YNc(36,ut,5,4,"div",23),t.qZA()()(),t.TgZ(37,"div",24)(38,"div",25),t._uU(39),t.ALo(40,"translate"),t.qZA(),t.YNc(41,gt,4,3,"div",26),t.YNc(42,Et,20,20,"div",27),t.qZA()()()()()()()),2&e&&(t.ekj("chrome-gt-100",o.isChromeVerGreaterThan100)("chrome-lt-100",!o.isChromeVerGreaterThan100),t.xp6(4),t.hij(" ",t.lcZ(5,23,"NewBroadcast")," "),t.xp6(12),t.hij(" ",t.lcZ(17,25,"ChooseTemplate")," "),t.xp6(3),t.s9C("placeholder",t.lcZ(20,27,"ChooseTemplate")),t.Q6J("clearable",!1)("searchable",!1)("ngModel",o.templateName)("items",o.templates_list),t.xp6(3),t.Q6J("disabled",!o.selected_template)("ngClass",t.VKq(37,wt,!o.selected_template)),t.xp6(1),t.hij(" ",t.lcZ(24,29,"ImportFromCSV")," "),t.xp6(5),t.hij(" ",t.lcZ(29,31,"ContactsList")," "),t.xp6(2),t.Q6J("ngIf",(null==o.parsedCsvData?null:o.parsedCsvData.length)>0),t.xp6(2),t.Q6J("disabled",!o.parsedCsvData),t.xp6(1),t.hij(" ",t.lcZ(34,33,"StartBroadcast")," "),t.xp6(2),t.Q6J("ngIf",!o.parsedCsvData),t.xp6(1),t.Q6J("ngIf",(null==o.parsedCsvData?null:o.parsedCsvData.length)>0),t.xp6(3),t.hij(" ",t.lcZ(40,35,"TemplatePreview")," "),t.xp6(2),t.Q6J("ngIf",!o.selected_template),t.xp6(1),t.Q6J("ngIf",o.selected_template))},dependencies:[f.mk,f.sg,f.O5,z.w9,Z.JJ,Z.On,C.BZ,C.fO,C.as,C.w1,C.Dz,C.nj,C.ge,C.ev,C.XQ,C.Gk,I.X$,nt.r,ot.N,at,it],styles:['.chrome-gt-100[_ngcontent-%COMP%] {\n  margin-top: -64px;\n}\n\n.chrome-lt-100[_ngcontent-%COMP%] {\n  margin-top: 6px;\n}\n\n.go--back[_ngcontent-%COMP%] {\n  cursor: pointer;\n  color: #6a6a6a;\n}\n\n.go--back[_ngcontent-%COMP%]:hover {\n  color: var(--accent-text-color);\n}\n\n.active-breadcrumb[_ngcontent-%COMP%] {\n  font-weight: 400;\n}\n\n.select-and-btn-wpr[_ngcontent-%COMP%] {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  gap: 16px;\n}\n\n.button--only--text[_ngcontent-%COMP%] {\n  background: transparent;\n  border: unset;\n  color: var(--blue-20);\n  font-weight: 400;\n  border-radius: 4px;\n}\n\n.button--only--text[_ngcontent-%COMP%]:hover {\n  background: var(--only-text-btn-hover-background);\n}\n\n.button--only--text-disabled[_ngcontent-%COMP%] {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n\n.b-flex-container[_ngcontent-%COMP%] {\n  display: flex;\n  width: 100%;\n  gap: 16px;\n  margin-top: 12px;\n  margin-left: 5px;\n  padding-right: 15px;\n}\n\n.b-left-columns-container[_ngcontent-%COMP%] {\n  flex: 1;\n  \n  min-width: 0; \n}\n\n.b-left--columns[_ngcontent-%COMP%] {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n  min-width: 0; \n}\n\n.template-select-label[_ngcontent-%COMP%] {\n  font-family: var(--header-font-family);\n  font-weight: 400;\n}\n\n.choose-wa-tmplt-label-and-select-wpr[_ngcontent-%COMP%] {\n  box-shadow: var(--card-elevation);\n  border-radius: var(--cl-card-border-radius);\n  padding: 16px;\n  max-height: -moz-fit-content;\n  max-height: fit-content;\n}\n\n.contacts-columns[_ngcontent-%COMP%] {\n  box-shadow: var(--card-elevation);\n  border-radius: var(--cl-card-border-radius);\n  padding: 16px;\n  min-width: 0; \n}\n\n.contacts-columns-header-wpr[_ngcontent-%COMP%] {\n  display: flex;\n  align-items: center;\n  flex-direction: row;\n  margin-bottom: 12px;\n  gap: 16px;\n  justify-content: space-between;\n}\n\n.contacts-columns-header[_ngcontent-%COMP%] {\n  font-family: var(--header-font-family);\n  font-weight: 400;\n  font-size: 14px;\n}\n\n.send-wa-btn[_ngcontent-%COMP%] {\n  background: var(--blue-20);\n  border: unset;\n  border-radius: 9999px;\n  vertical-align: middle;\n  color: #fff;\n  padding: 6px 12px;\n  box-shadow: unset;\n  text-transform: unset;\n  margin: 0px;\n  font-size: 14px;\n}\n\n.b-right-column[_ngcontent-%COMP%] {\n  width: 360px;\n  flex-shrink: 0;\n  \n  box-shadow: var(--card-elevation);\n  border-radius: var(--cl-card-border-radius);\n  max-height: -moz-fit-content;\n  max-height: fit-content;\n  min-height: 234px;\n}\n\n.preview-template-header[_ngcontent-%COMP%] {\n  padding: 8px;\n  font-family: var(--header-font-family);\n  background-color: rgb(241, 244, 247);\n  height: 40px;\n  display: flex;\n  align-items: center;\n  font-weight: 400;\n}\n\n\n\n.preview-container[_ngcontent-%COMP%]::before {\n  background: url(https://static.xx.fbcdn.net/rsrc.php/v4/yb/r/rmr3BrOAAd8.png);\n  background-size: 366.5px 666px;\n  content: "";\n  height: 100%;\n  left: 0;\n  opacity: 0.06;\n  position: absolute;\n  top: 0;\n  width: 100%;\n}\n\n.preview-container[_ngcontent-%COMP%] {\n  display: flex;\n  background-color: #e5ddd5;\n  background-repeat: no-repeat;\n  background-size: cover;\n  border-bottom-left-radius: 6px;\n  border-bottom-right-radius: 6px;\n  overflow: hidden;\n  transition: max-height 0.6s;\n  justify-content: center;\n  position: relative;\n}\n\n.preview-container[_ngcontent-%COMP%]   .inner-preview-container[_ngcontent-%COMP%] {\n  padding: 6px 6px;\n  margin-top: 12px;\n  margin-bottom: 12px;\n}\n\n.preview-container-active[_ngcontent-%COMP%] {\n  max-height: 500px;\n}\n\n.message-cloud[_ngcontent-%COMP%] {\n  background-color: #fff;\n  width: 280px;\n  padding: 8px 10px 2px 10px;\n  border-radius: 8px;\n  box-shadow: 0 1px 0.5px rgba(0, 0, 0, 0.15);\n  font-size: 12px;\n  position: relative;\n}\n\n.message-cloud[_ngcontent-%COMP%]   .header-preview[_ngcontent-%COMP%] {\n  color: rgba(0, 0, 0, 0.76);\n  font-size: 16px;\n  font-weight: bold;\n  line-height: 19px;\n  padding-bottom: 8px;\n}\n\n.message-cloud[_ngcontent-%COMP%]   .header-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\n  max-width: 100%;\n  border-radius: 6px;\n  animation: fadein 1s;\n}\n\n@keyframes fadein {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n.message-cloud[_ngcontent-%COMP%]   .header-preview[_ngcontent-%COMP%]   .pdf-preview[_ngcontent-%COMP%] {\n  width: 100%;\n  height: 100%;\n  background-color: #d3dbe5;\n  border-radius: 6px;\n  padding: 26px;\n  display: flex;\n  justify-content: center;\n}\n\n.message-cloud[_ngcontent-%COMP%]   .header-preview[_ngcontent-%COMP%]   .pdf-preview[_ngcontent-%COMP%]   p[_ngcontent-%COMP%] {\n  padding: 10px;\n  color: white;\n  background-color: #80868b;\n  border-radius: 12px;\n  width: 70px;\n  text-align: center;\n}\n\n.message-cloud[_ngcontent-%COMP%]   .header-preview[_ngcontent-%COMP%]   .location-preview[_ngcontent-%COMP%] {\n  width: 100%;\n  height: 100%;\n  background-color: #d3dbe5;\n  border-radius: 6px;\n  padding: 26px;\n  display: flex;\n  justify-content: center;\n  background-image: url("https://media.istockphoto.com/id/1306807452/vector/map-city-vector-illustration.jpg?s=612x612&w=0&k=20&c=8efOIy-Ft3trEzeDk3PY2WRjWws8mvKXgkLqCZ2cP5A=");\n  background-size: contain;\n}\n\n.message-cloud[_ngcontent-%COMP%]   .header-preview[_ngcontent-%COMP%]   .location-preview[_ngcontent-%COMP%]   p[_ngcontent-%COMP%] {\n  padding: 10px;\n  color: white;\n  background-color: #80868b;\n  border-radius: 12px;\n  width: 100px;\n  text-align: center;\n}\n\n.message-cloud[_ngcontent-%COMP%]   .body-preview[_ngcontent-%COMP%] {\n  font-size: 14px;\n  color: #282828;\n  line-height: 19px;\n  font-weight: 400;\n}\n\n.message-cloud[_ngcontent-%COMP%]   .footer-preview[_ngcontent-%COMP%] {\n  padding-top: 6px;\n  color: rgba(0, 0, 0, 0.4509803922);\n  font-size: 11.6px;\n  line-height: 17px;\n  font-size: 13px;\n  font-weight: 400;\n}\n\n.message-cloud[_ngcontent-%COMP%]   .whatsapp-call-to-action[_ngcontent-%COMP%]:first-child {\n  margin-top: 8px;\n}\n\n.message-cloud[_ngcontent-%COMP%]   .whatsapp-call-to-action[_ngcontent-%COMP%] {\n  background-color: #fff;\n  color: #00a5f4;\n  width: 100%;\n  height: 40px;\n  font-size: 14px;\n  text-transform: none;\n  border-radius: 0px;\n  box-shadow: none;\n  padding: 0px;\n  margin: 2px 0px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-top: 1px solid #DADDE1;\n}\n\n.message-cloud[_ngcontent-%COMP%]   .call-to-action-icon[_ngcontent-%COMP%] {\n  font-size: 16px;\n  margin-right: 6px;\n}\n\n.message-cloud[_ngcontent-%COMP%]::before {\n  content: "";\n  position: absolute;\n  top: -3px;\n  left: -9px;\n  width: 0;\n  height: 0;\n  border-left: 12px solid transparent;\n  border-right: 12px solid transparent;\n  border-bottom: 16px solid white;\n  transform: rotate(52deg);\n}\n\n.no-template-selected-container[_ngcontent-%COMP%] {\n  display: flex;\n  justify-content: center;\n}\n\n.no-template-selected[_ngcontent-%COMP%] {\n  margin-top: 25px;\n  margin-top: 25px;\n  color: #aaa;\n  font-weight: 400;\n}\n\nbutton.icon-only[_ngcontent-%COMP%] {\n  height: 36px;\n  width: 40px;\n  margin-left: 4px;\n  border-radius: 8px;\n  background: var(--blu-light-02);\n  border: 1px solid var(--blu-light-02) !important;\n  color: var(--color-white-hex);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\nbutton.icon-only[_ngcontent-%COMP%]:hover {\n  opacity: 0.8;\n}\n\n.message-cloud-buttons-container[_ngcontent-%COMP%] {\n  width: 280px;\n}\n\n.message-cloud-buttons[_ngcontent-%COMP%] {\n  margin: 0 -1.5px;\n  border: none;\n  box-sizing: border-box;\n  display: flex;\n  flex-wrap: wrap;\n  width: 283px;\n  z-index: 1;\n  position: relative;\n}\n\n.message-cloud-button[_ngcontent-%COMP%] {\n  margin: 3px 1.5px 0;\n  border-radius: 7.5px;\n  padding: 6px 7px 8px 9px;\n  min-width: calc(50% - 3px);\n  height: 36px;\n  flex-grow: 1;\n  background-color: white;\n  color: #00a5f4;\n  box-shadow: 0 1px 0.5px rgba(0, 0, 0, 0.15);\n  font-size: 14px;\n  font-weight: 400;\n  letter-spacing: 0px;\n  border: none;\n}\n\n.url-button-previsioning[_ngcontent-%COMP%] {\n  padding: 8px 8px;\n  border-radius: 4px;\n  background-color: rgba(24, 119, 242, 0.1019607843);\n}\n\n.url-button-previsioning[_ngcontent-%COMP%]   .previsioning-url[_ngcontent-%COMP%] {\n  margin: 0px;\n}\n\n.url-button-previsioning[_ngcontent-%COMP%]   .whatsapp-call-to-action[_ngcontent-%COMP%] {\n  background-color: #fff;\n  color: #00a5f4;\n  \n  width: 100%;\n  height: 40px;\n  font-size: 14px;\n  text-transform: none;\n  border-radius: 6px;\n  \n  box-shadow: none;\n  padding: 0px;\n  margin: 2px 0px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border: none;\n  width: 200px;\n  font-weight: 400;\n}\n\n.url-button-previsioning[_ngcontent-%COMP%]   .call-to-action-icon[_ngcontent-%COMP%] {\n  font-size: 16px;\n  margin-right: 6px;\n}\n\n.header-image-container[_ngcontent-%COMP%] {\n  width: 100%;\n  background-color: #dcdcdc;\n  border-radius: 6px;\n  background-position: center;\n  background-repeat: no-repeat;\n  background-size: cover;\n  overflow: hidden;\n}\n\n.no-file-uploaded[_ngcontent-%COMP%] {\n  display: flex;\n  justify-content: center;\n  color: #aaa;\n  font-weight: 400;\n  flex-direction: column;\n  align-items: center;\n  line-height: 27px;\n}\n\n.custom-csv-table[_ngcontent-%COMP%]   tr.mat-header-row[_ngcontent-%COMP%] {\n  height: 40px;\n}\n\n.custom-csv-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%] {\n  background: #fafafa;\n}\n\n.custom-csv-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%] {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  max-width: 200px;\n}\n\n.csv-table-scroll-wrapper[_ngcontent-%COMP%] {\n  max-height: 400px; \n  overflow-y: auto;\n  overflow-x: auto;\n  display: block;\n  white-space: nowrap; \n  width: 100%;\n  -webkit-overflow-scrolling: touch; \n}\n\n.custom-csv-table[_ngcontent-%COMP%] {\n  border-collapse: collapse;\n  min-width: 100%; \n  white-space: nowrap; \n}\n\n\n\n.custom-csv-table.mat-table[_ngcontent-%COMP%] {\n  width: max-content !important; \n  min-width: 100%;\n  table-layout: auto;\n  white-space: nowrap;\n}\n\n\n\n.custom-csv-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .custom-csv-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%] {\n  padding: 8px;\n  border-bottom: 1px solid #ddd;\n  text-align: left;\n}\n\n.custom-csv-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%] {\n  position: sticky;\n  top: 0;\n  background: #f5f5f5;\n  z-index: 2;\n}\n\n.body-preview[_ngcontent-%COMP%]    > span[_ngcontent-%COMP%]     .csv-col-label {\n  display: inline-block;\n  background: #e3e9f6;\n  color: #0f62ff;\n  font-size: 11px;\n  border-radius: 4px;\n  padding: 0 4px;\n  font-weight: 500;\n  font-style: normal !important;\n}']}),n})();var Mt=s(69284),Pt=s(31449);const It=[{path:"",component:yt}];let Ut=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[P.Bz.forChild(It),f.ez,I.aw,Mt.i,Pt.m,z.A0,Z.u5,x.Is,R.ot,C.p0]}),n})()},69284:(Y,M,s)=>{s.d(M,{i:()=>g});var f=s(69808),P=s(93075),x=s(51062),v=s(87238),y=s(5e3);let g=(()=>{class t{}return t.\u0275fac=function(I){return new(I||t)},t.\u0275mod=y.oAB({type:t}),t.\u0275inj=y.cJS({imports:[f.ez,P.u5,x.aw,v.AV]}),t})()},78558:(Y,M,s)=>{s.d(M,{N:()=>x});var f=s(7623),P=s(5e3);let x=(()=>{class v{transform(g,t){return g=(0,f.M3)(g),(g=(0,f.I4)(g)).trim()}}return v.\u0275fac=function(g){return new(g||v)},v.\u0275pipe=P.Yjl({name:"htmlEntitiesEncode",type:v,pure:!0}),v})()}}]);